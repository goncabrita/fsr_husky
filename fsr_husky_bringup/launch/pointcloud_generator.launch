<?xml version="1.0"?>
<launch>

	<!-- Convert tilt laser scan to pointcloud -->
	<node pkg="laser_filters" type="scan_to_cloud_filter_chain" output="screen" name="scan_to_cloud_filter_chain_tilt_laser">
	    <remap from="scan" to="scan"/>
	    <remap from="cloud_filtered" to="tilt_scan_cloud"/>
	    <param name="target_frame" type="string" value="base_link"/>
	    <!--<rosparam command="load" file="$(find fsr_husky_bringup)/settings/shadow_filter.yaml" />-->
	</node>
	
	<!-- MoveIt will take care of self-filtering -->
	
	<!-- >ssemble pointcloud into a full world view -->
	<node pkg="laser_assembler" type="point_cloud2_assembler" output="screen"  name="point_cloud_assembler">
	    <remap from="cloud" to="/move_group/tilt_scan_cloud_filtered"/>
	    <param name="tf_cache_time_secs" type="double" value="10.0" />
	    <param name="tf_tolerance_secs" type="double" value="0.01" />
	    <param name="max_clouds" type="int" value="400" />
	    <param name="ignore_laser_skew" type="bool" value="true" />
	    <param name="fixed_frame" type="string" value="odom" />
	</node>

	<!-- PointCloud Generator - Tilts the laser and generates PointClouds -->
  	<node type="cloud_assembler_node" pkg="fsr_husky_driver" name="pointcloud_generator" output="screen">
	    <param name="lower_tilt" value="-0.5" />
	    <param name="upper_tilt" value="0.5" />
	    <param name="tilt_speed" value="0.8" />
	</node>

</launch>